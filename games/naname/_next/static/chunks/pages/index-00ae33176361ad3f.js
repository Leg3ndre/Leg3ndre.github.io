(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[332],{5855:i=>{i.exports={scores:"index_scores__c1eQ3",pl_score:"index_pl_score__VhfVA",en_score:"index_en_score__ilKsR",desc:"index_desc__Q_pr8",abstract:"index_abstract__JOnAS",playManual:"index_playManual__r_4Hj"}},6760:(i,t,s)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/",function(){return s(8417)}])},8417:(i,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>P});var e=s(7876),o=s(6691),h=s(4796),r=s(4232),n=s(9120),a=s.n(n);let l=i=>{let{keysPressed:t}=i;(0,r.useEffect)(()=>(document.addEventListener("keydown",s),document.addEventListener("keyup",o),()=>{document.removeEventListener("keydown",s),document.removeEventListener("keyup",o)}),[]);let s=i=>{t[i.key]=!0},o=i=>{delete t[i.key]};return(0,e.jsx)(e.Fragment,{})},c=i=>{let t=0,s=()=>{let e=Date.now();e-t>16.666666666666668&&(t=e,i()),requestAnimationFrame(s)};s()};class d{buildGraphics(){let i=new o.YJl;for(let t of this.wLines)i.add(t);for(let t of this.sLines)i.add(t);return i}buildSLines(){let i=[];for(let t=0;t<=16;++t){let s=new o.LoY;s.setFromPoints(this.buildSLineEdges(t)),i.push(new o.N1A(s,this.material))}return i}buildWLines(){let i=[];for(let t=0;t<=32;++t){let s=new o.LoY;s.setFromPoints(this.buildWLineEdges(t)),i.push(new o.N1A(s,this.material))}return i}buildSLineEdges(i){let t=50*i-400;return[new o.Pq0(-800,t,-400),new o.Pq0(800,t,-400)]}buildWLineEdges(i){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,s=50*i-800,e=t%50;return[new o.Pq0(s-e,-400,-400),new o.Pq0(s-e,400,-400)]}moveWLines(i){for(let[t,s]of this.wLines.entries())s.geometry.setFromPoints(this.buildWLineEdges(t,i))}constructor(){this.material=new o.mrM({color:0xc0d0e0}),this.sLines=this.buildSLines(),this.wLines=this.buildWLines()}}class u{tick(){this.count+=this.VELOCITY,this.builder.moveWLines(this.count)}constructor(){this.VELOCITY=3,this.count=0,this.builder=new d,this.graphics=this.builder.buildGraphics()}}class p{buildGraphics(){return this.group.add(this.buildWing()),this.group.add(this.buildBody()),this.group}buildWing(){let i=new o.LoY;return i.setFromPoints(this.buildWingEdges()),new o.N1A(i,this.material)}buildWingEdges(){return[new o.Pq0(20,0,0),new o.Pq0(20*Math.cos(2*Math.PI/3),20*Math.sin(2*Math.PI/3),0),new o.Pq0(20*Math.cos(4*Math.PI/3),20*Math.sin(4*Math.PI/3),0),new o.Pq0(20,0,0)]}buildBody(){let i=new o.LoY;return i.setFromPoints(this.buildBodyEdges()),new o.N1A(i,this.material)}buildBodyEdges(){return[new o.Pq0(20,0,0),new o.Pq0(20*Math.cos(2*Math.PI/3),0,0),new o.Pq0(20*Math.cos(4*Math.PI/3),0,20*Math.sin(4*Math.PI/3)),new o.Pq0(20,0,0)]}colorNormal(){for(let i of this.group.children)i.material=this.material}colorAttacked(){for(let i of this.group.children)i.material=this.materialAttacked}constructor(){this.material=new o.mrM({color:0xff0000}),this.materialAttacked=new o.mrM({color:0xffffff}),this.group=new o.YJl}}class m{buildGraphics(){return new o.eaF(this.geometry,this.material)}dispose(){this.material.dispose(),this.geometry.dispose()}constructor(i,t){this.wSegments=32,this.hSegments=15,this.material=new o.V9B({color:i}),this.geometry=new o.Gu$(t,this.wSegments,this.hSegments)}}class w{tick(){this.position.add(this.velocity),this.position.x>800&&(this.isAlive=!1),this.position.x<-960&&(this.isAlive=!1),this.position.y>800&&(this.isAlive=!1),this.position.y<-800&&(this.isAlive=!1),this.position.z>800&&(this.isAlive=!1),this.position.z<-800&&(this.isAlive=!1)}isAttacking(i,t){let s=this.radius+t,e=this.position.clone().sub(i);return Math.abs(e.x)<s&&Math.abs(e.y)<s&&Math.abs(e.z)<s}dispose(){this.builder.dispose()}constructor(i,t,s){this.radius=10,this.isAlive=!0,this.builder=new m(s,this.radius),this.graphics=this.builder.buildGraphics(),Object.assign(this.graphics.position,i.clone()),this.position=this.graphics.position,this.velocity=t.clone()}}class g{tick(){for(let i of this.list)i.tick();this.removeDeadShot()}generate(i){let t=new w(i,new o.Pq0(this.velocity,0,0),this.SHOT_COLOR);this.list.push(t),this.graphics.add(t.graphics)}isAttacking(i,t){for(let s of this.list)if(s.isAttacking(i,t))return!0;return!1}removeDeadShot(){for(let i of this.list)i.isAlive||(this.graphics.remove(i.graphics),i.dispose());this.list=this.list.filter(i=>i.isAlive)}constructor(){this.list=[],this.velocity=10,this.SHOT_COLOR=0xd0d000,this.graphics=new o.YJl}}class f{tick(i,t,s){this.updatePosition(i),this.shoot(i),this.shotList.tick(),this.processDameged(t,s),this.isInvincible()&&this.restIFrame--}updatePosition(i){let t=this.position;(i.w||i.ArrowUp)&&(t.z+=this.velocity),(i.s||i.ArrowDown)&&(t.z-=this.velocity),(i.a||i.ArrowLeft)&&(t.y+=this.velocity),(i.d||i.ArrowRight)&&(t.y-=this.velocity),(i.e||i.x)&&(t.x+=this.velocity),(i.q||i.z)&&(t.x-=this.velocity),this.regularizePosition()}regularizePosition(){this.position.x=Math.max(Math.min(this.position.x,800),-800),this.position.y=Math.max(Math.min(this.position.y,400),-400),this.position.z=Math.max(Math.min(this.position.z,400),-400)}shoot(i){if(this.restSFrame>0)return void this.restSFrame--;(i[" "]||i.Enter)&&(this.shotList.generate(this.position),this.restSFrame=this.SHOOT_INTERVAL)}processDameged(i,t){!this.isInvincible()&&this.detectAttacked(i,t)&&(this.life--,this.restIFrame=30),this.isInvincible()?this.builder.colorAttacked():this.builder.colorNormal()}detectAttacked(i,t){for(let t of i)if(t.isAttacking(this.position,this.radius))return!0;for(let i of t)if(i.isAttacking(this.position,this.radius))return!0;return!1}isInvincible(){return this.restIFrame>0}constructor(){this.radius=15,this.velocity=8,this.life=5,this.shotList=new g,this.SHOOT_INTERVAL=15,this.restSFrame=0,this.restIFrame=0,this.builder=new p,this.graphics=this.builder.buildGraphics(),this.position=this.graphics.position}}class v{buildGraphics(i){let t=new o.Zpd(i,0),s=new o.eaF(t,this.material);return s.rotation.z=-Math.PI/4,s.rotation.y=-Math.PI/3,this.group.add(s),this.group}doDeadAction(){this.group.rotation.x+=.4,this.group.rotation.z+=.4}dispose(){for(let i of this.group.children)i.material.dispose(),i.geometry.dispose()}constructor(i){this.material=new o.G_z({color:i}),this.group=new o.YJl}}class x{tick(i,t){if(this.isShotDown)return this.tickBeforeDead();this.count++,this.position.add(this.velocity),this.position.x<-1200&&(this.isAlive=!1),i.isAttacking(this.position,this.radius)&&(this.isShotDown=!0)}tickBeforeDead(){this.countBeforeDead++,this.position.x+=1,this.position.z-=this.countBeforeDead,this.builder.doDeadAction(),this.countBeforeDead>=30&&(this.isAlive=!1)}shoot(i){return!this.isAlive||this.isShotDown||this.count%this.SHOOT_INTERVAL!=0?null:this.buildNewShot(i)}buildNewShot(i){let t=new o.Pq0;return t.randomDirection().multiplyScalar(this.SHOOT_SPEED),t.x=-Math.abs(t.x),t.add(this.velocity),new w(this.position,t,this.SHOT_COLOR)}isAttacking(i,t){if(!this.isAlive)return!1;let s=this.radius+t,e=this.position.clone().sub(i);return Math.abs(e.x)<s&&Math.abs(e.y)<s&&Math.abs(e.z)<s}dispose(){this.builder.dispose()}constructor(i=0xe0e0e0){this.radius=40,this.isAlive=!0,this.isShotDown=!1,this.SHOT_COLOR=0xe0e0e0,this.SHOOT_INTERVAL=7.5,this.SHOOT_SPEED=4,this.count=0,this.countBeforeDead=0,this.builder=new v(i),this.graphics=this.builder.buildGraphics(this.radius),Object.assign(this.graphics.position,new o.Pq0(800,(2*Math.random()-1)*400,(2*Math.random()-1)*400)),this.position=this.graphics.position,this.velocity=new o.Pq0(-3,0,0)}}let b=x;class S extends b{tick(i,t){this.updateVelocity(t),super.tick(i)}updateVelocity(i){this.velocity.y=-.008333333333333333*(this.position.y-i.y),this.velocity.z=-.008333333333333333*(this.position.z-i.z)}buildNewShot(i){let t=new o.Pq0;return t.x=-Math.abs(this.position.x-i.x),t.y=-(this.position.y-i.y),t.z=-(this.position.z-i.z),t.normalize().multiplyScalar(this.SHOOT_SPEED),new w(this.position,t,this.SHOT_COLOR)}constructor(){super(0xf04040),this.SHOT_COLOR=0xffd0d0,this.SHOOT_INTERVAL=30,this.SHOOT_SPEED=4}}class y extends b{tick(i){this.randomizeVelocity(),super.tick(i)}randomizeVelocity(){let i=4+6*Math.random(),t=1-2*Math.floor(2*Math.random()),s=(.1*this.count+Math.random())*t;this.velocity.y=i*Math.cos(s),this.velocity.z=i*Math.sin(s)}constructor(){super(5263600),this.SHOT_COLOR=0xc0d0ff}}class _ extends b{buildNewShot(){let i=.01*this.count,t=new o.Pq0(-.5,Math.sin(5*i)*Math.cos(i),Math.sin(5*i)*Math.sin(i));return t.normalize().multiplyScalar(this.SHOOT_SPEED),t.add(this.velocity),new w(this.position,t,this.SHOT_COLOR)}constructor(){super(57344),this.SHOT_COLOR=0xd0ffd0,this.SHOOT_INTERVAL=6,this.SHOOT_SPEED=1}}class L{tick(i,t){for(let s of(this.count++,this.canGenerate()&&this.generate(),this.list)){s.tick(i,t);let e=s.shoot(t);null!=e&&(this.shotList.push(e),this.graphics.add(e.graphics))}for(let i of(this.removeDeadEnemies(),this.shotList))i.tick();this.removeDeadShot()}generate(){let i,t=Math.floor(3e4*Math.random());i=t%3==0?new S:t%3==1?new y:new _,this.list.push(i),this.graphics.add(i.graphics)}canGenerate(){return this.count<=1800?this.count%180==0:this.count<=3600?this.count%120==0:this.count<=7200?this.count%60==0:this.count%30==0}removeDeadEnemies(){for(let i of(this.countShotDown=this.list.filter(i=>!i.isAlive&&i.isShotDown).length,this.list))i.isAlive||(this.graphics.remove(i.graphics),i.dispose());this.list=this.list.filter(i=>i.isAlive)}removeDeadShot(){for(let i of this.shotList)i.isAlive||(this.graphics.remove(i.graphics),i.dispose());this.shotList=this.shotList.filter(i=>i.isAlive)}buildGraphics(){return new o.YJl}constructor(){this.list=[],this.shotList=[],this.countShotDown=0,this.count=0,this.graphics=this.buildGraphics()}}let O=i=>{let t,{width:s,height:n,setPlayerLife:d,setScore:p}=i,m=(0,r.useRef)(0),w={},g=new u,v=new f,x=new L,b=new o.Z58,S=new o.dth(0xffffff,6316128,5),y=new o.ubm(60,s/n);return y.position.set(0,-800,800),y.lookAt(new o.Pq0(0,0,0)),b.add(S),b.add(g.graphics),b.add(v.graphics),b.add(v.shotList.graphics),b.add(x.graphics),(0,r.useEffect)(()=>{document.body.addEventListener("keydown",i=>i.preventDefault())}),(0,r.useEffect)(()=>{(t=new h.JeP({canvas:document.getElementById("game")})).setPixelRatio(window.devicePixelRatio),t.setSize(s,n)},[]),(0,r.useEffect)(()=>{c(()=>{void 0!==t&&(g.tick(),v.tick(w,x.list,x.shotList),d(v.life),x.tick(v.shotList,v.position),p(m.current+=x.countShotDown),t.render(b,y))})},[]),(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(l,{keysPressed:w}),(0,e.jsx)("canvas",{id:"game",width:s,height:n,className:a().gameCanvas})]})};var A=s(5855),E=s.n(A);let P=()=>{let[i,t]=(0,r.useState)(5),[s,o]=(0,r.useState)(0);return(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)("h1",{children:"Naname Shooting"}),(0,e.jsxs)("div",{className:E().scores,children:[(0,e.jsxs)("span",{id:"pl-score",className:E().pl_score,children:["PLAYER'S LIFE: ",i]}),(0,e.jsxs)("span",{id:"en-score",className:E().en_score,children:["KILL SCORE: ",s]})]}),(0,e.jsx)(O,{width:640,height:480,setPlayerLife:t,setScore:o}),(0,e.jsxs)("div",{className:E().desc,children:[(0,e.jsx)("p",{className:E().abstract,children:"固定視点の3Dシューティングゲームです。 プレイヤーから見て右上にカメラが固定されているため、上移動と左移動の区別は遠近感でがんばってください。"}),(0,e.jsxs)("ul",{className:E().playManual,children:[(0,e.jsx)("li",{children:"画面右から次々現れる敵を倒し、スコアを稼いでください"}),(0,e.jsx)("li",{children:"プレイヤーが操作する自機は赤い紙飛行機です。敵に弾を当てると倒すことができます"}),(0,e.jsx)("li",{children:"敵の弾が自機に当たるとライフが減ります"}),(0,e.jsx)("li",{children:"※ 現状では自機のライフが0になってもゲームは終了しません"}),(0,e.jsx)("li",{children:"操作方法"}),(0,e.jsxs)("ul",{children:[(0,e.jsx)("li",{children:"↑ or W: 上へ移動"}),(0,e.jsx)("li",{children:"↓ or S: 下へ移動"}),(0,e.jsx)("li",{children:"← or A: 左へ移動"}),(0,e.jsx)("li",{children:"→ or D: 右へ移動"}),(0,e.jsx)("li",{children:"X or E: 前へ移動"}),(0,e.jsx)("li",{children:"Z or Q: 後ろへ移動"}),(0,e.jsx)("li",{children:"Space or Enter: 弾を発射"})]})]})]})]})}},9120:i=>{i.exports={gameCanvas:"gameCanvas_gameCanvas__v5Dar"}}},i=>{var t=t=>i(i.s=t);i.O(0,[391,334,636,593,792],()=>t(6760)),_N_E=i.O()}]);