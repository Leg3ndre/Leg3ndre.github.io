(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[332],{5855:t=>{t.exports={scores:"index_scores__c1eQ3",pl_score:"index_pl_score__VhfVA",en_score:"index_en_score__ilKsR"}},6760:(t,i,s)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/",function(){return s(8417)}])},8417:(t,i,s)=>{"use strict";s.r(i),s.d(i,{default:()=>E});var e=s(7876),o=s(6691),h=s(4796),r=s(4232),n=s(9120),a=s.n(n);let l=t=>{let{keysPressed:i}=t;(0,r.useEffect)(()=>(document.addEventListener("keydown",s),document.addEventListener("keyup",o),()=>{document.removeEventListener("keydown",s),document.removeEventListener("keyup",o)}),[]);let s=t=>{i[t.key]=!0},o=t=>{delete i[t.key]};return(0,e.jsx)(e.Fragment,{})},c=t=>{let i=0,s=()=>{let e=Date.now();e-i>16.666666666666668&&(i=e,t()),requestAnimationFrame(s)};s()};class d{buildGraphics(){let t=new o.YJl;for(let i of this.wLines)t.add(i);for(let i of this.sLines)t.add(i);return t}buildSLines(){let t=[];for(let i=0;i<=16;++i){let s=new o.LoY;s.setFromPoints(this.buildSLineEdges(i)),t.push(new o.N1A(s,this.material))}return t}buildWLines(){let t=[];for(let i=0;i<=32;++i){let s=new o.LoY;s.setFromPoints(this.buildWLineEdges(i)),t.push(new o.N1A(s,this.material))}return t}buildSLineEdges(t){let i=50*t-400;return[new o.Pq0(-800,i,-400),new o.Pq0(800,i,-400)]}buildWLineEdges(t){let i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,s=50*t-800,e=i%50;return[new o.Pq0(s-e,-400,-400),new o.Pq0(s-e,400,-400)]}moveWLines(t){for(let[i,s]of this.wLines.entries())s.geometry.setFromPoints(this.buildWLineEdges(i,t))}constructor(){this.material=new o.mrM({color:0xc0d0e0}),this.sLines=this.buildSLines(),this.wLines=this.buildWLines()}}class u{tick(){this.count+=this.VELOCITY,this.builder.moveWLines(this.count)}constructor(){this.VELOCITY=3,this.count=0,this.builder=new d,this.graphics=this.builder.buildGraphics()}}class p{buildGraphics(){return this.group.add(this.buildWing()),this.group.add(this.buildBody()),this.group}buildWing(){let t=new o.LoY;return t.setFromPoints(this.buildWingEdges()),new o.N1A(t,this.material)}buildWingEdges(){return[new o.Pq0(20,0,0),new o.Pq0(20*Math.cos(2*Math.PI/3),20*Math.sin(2*Math.PI/3),0),new o.Pq0(20*Math.cos(4*Math.PI/3),20*Math.sin(4*Math.PI/3),0),new o.Pq0(20,0,0)]}buildBody(){let t=new o.LoY;return t.setFromPoints(this.buildBodyEdges()),new o.N1A(t,this.material)}buildBodyEdges(){return[new o.Pq0(20,0,0),new o.Pq0(20*Math.cos(2*Math.PI/3),0,0),new o.Pq0(20*Math.cos(4*Math.PI/3),0,20*Math.sin(4*Math.PI/3)),new o.Pq0(20,0,0)]}colorNormal(){for(let t of this.group.children)t.material=this.material}colorAttacked(){for(let t of this.group.children)t.material=this.materialAttacked}constructor(){this.material=new o.mrM({color:0xff0000}),this.materialAttacked=new o.mrM({color:0xffffff}),this.group=new o.YJl}}class m{buildGraphics(){return new o.eaF(this.geometry,this.material)}dispose(){this.material.dispose(),this.geometry.dispose()}constructor(t,i){this.wSegments=32,this.hSegments=15,this.material=new o.V9B({color:t}),this.geometry=new o.Gu$(i,this.wSegments,this.hSegments)}}class w{tick(){this.position.add(this.velocity),this.position.x>1600&&(this.isAlive=!1),this.position.x<-1600&&(this.isAlive=!1)}isAttacking(t,i){let s=this.radius+i,e=this.position.clone().sub(t);return Math.abs(e.x)<s&&Math.abs(e.y)<s&&Math.abs(e.z)<s}dispose(){this.builder.dispose()}constructor(t,i,s){this.radius=10,this.isAlive=!0,this.builder=new m(s,this.radius),this.graphics=this.builder.buildGraphics(),Object.assign(this.graphics.position,t.clone()),this.position=this.graphics.position,this.velocity=i.clone()}}class g{tick(){for(let t of this.list)t.tick();this.removeDeadShot()}generate(t){let i=new w(t,new o.Pq0(this.velocity,0,0),this.SHOT_COLOR);this.list.push(i),this.graphics.add(i.graphics)}isAttacking(t,i){for(let s of this.list)if(s.isAttacking(t,i))return!0;return!1}removeDeadShot(){for(let t of this.list)t.isAlive||(this.graphics.remove(t.graphics),t.dispose());this.list=this.list.filter(t=>t.isAlive)}constructor(){this.list=[],this.velocity=10,this.SHOT_COLOR=0xd0d000,this.graphics=new o.YJl}}class f{tick(t,i,s){this.updatePosition(t),this.shoot(t),this.shotList.tick(),this.processDameged(i,s),this.isInvincible()&&this.restIFrame--}updatePosition(t){let i=this.position;(t.w||t.ArrowUp)&&(i.z+=this.velocity),(t.s||t.ArrowDown)&&(i.z-=this.velocity),(t.a||t.ArrowLeft)&&(i.y+=this.velocity),(t.d||t.ArrowRight)&&(i.y-=this.velocity),(t.e||t.x)&&(i.x+=this.velocity),(t.q||t.z)&&(i.x-=this.velocity),this.regularizePosition()}regularizePosition(){this.position.x=Math.max(Math.min(this.position.x,800),-800),this.position.y=Math.max(Math.min(this.position.y,400),-400),this.position.z=Math.max(Math.min(this.position.z,400),-400)}shoot(t){if(this.restSFrame>0)return void this.restSFrame--;(t[" "]||t.Enter)&&(this.shotList.generate(this.position),this.restSFrame=this.SHOOT_INTERVAL)}processDameged(t,i){!this.isInvincible()&&this.detectAttacked(t,i)&&(this.life--,this.restIFrame=30),this.isInvincible()?this.builder.colorAttacked():this.builder.colorNormal()}detectAttacked(t,i){for(let i of t)if(i.isAttacking(this.position,this.radius))return!0;for(let t of i)if(t.isAttacking(this.position,this.radius))return!0;return!1}isInvincible(){return this.restIFrame>0}constructor(){this.radius=15,this.velocity=8,this.life=5,this.shotList=new g,this.SHOOT_INTERVAL=15,this.restSFrame=0,this.restIFrame=0,this.builder=new p,this.graphics=this.builder.buildGraphics(),this.position=this.graphics.position}}class v{buildGraphics(t){let i=new o.Zpd(t,0),s=new o.eaF(i,this.material);return s.rotation.z=-Math.PI/4,s.rotation.y=-Math.PI/3,this.group.add(s),this.group}doDeadAction(){this.group.rotation.x+=.4,this.group.rotation.z+=.4}dispose(){for(let t of this.group.children)t.material.dispose(),t.geometry.dispose()}constructor(t){this.material=new o.G_z({color:t}),this.group=new o.YJl}}class S{tick(t,i){if(this.isShotDown)return this.tickBeforeDead();this.count++,this.position.add(this.velocity),this.position.x<-1600&&(this.isAlive=!1),t.isAttacking(this.position,this.radius)&&(this.isShotDown=!0)}tickBeforeDead(){this.countBeforeDead++,this.position.x+=1,this.position.z-=this.countBeforeDead,this.builder.doDeadAction(),this.countBeforeDead>=30&&(this.isAlive=!1)}shoot(t){return!this.isAlive||this.isShotDown||this.count%this.SHOOT_INTERVAL!=0?null:this.buildNewShot(t)}buildNewShot(t){let i=new o.Pq0;return i.randomDirection().multiplyScalar(this.SHOOT_SPEED),i.x=-Math.abs(i.x),i.add(this.velocity),new w(this.position,i,this.SHOT_COLOR)}isAttacking(t,i){if(!this.isAlive)return!1;let s=this.radius+i,e=this.position.clone().sub(t);return Math.abs(e.x)<s&&Math.abs(e.y)<s&&Math.abs(e.z)<s}dispose(){this.builder.dispose()}constructor(t=0xe0e0e0){this.radius=40,this.isAlive=!0,this.isShotDown=!1,this.SHOT_COLOR=0xe0e0e0,this.SHOOT_INTERVAL=6,this.SHOOT_SPEED=4,this.count=0,this.countBeforeDead=0,this.builder=new v(t),this.graphics=this.builder.buildGraphics(this.radius),Object.assign(this.graphics.position,new o.Pq0(800,(2*Math.random()-1)*400,(2*Math.random()-1)*400)),this.position=this.graphics.position,this.velocity=new o.Pq0(-3,0,0)}}let b=S;class L extends b{tick(t,i){this.updateVelocity(i),super.tick(t)}updateVelocity(t){this.velocity.y=-.008333333333333333*(this.position.y-t.y),this.velocity.z=-.008333333333333333*(this.position.z-t.z)}buildNewShot(t){let i=new o.Pq0;return i.x=-Math.abs(this.position.x-t.x),i.y=-(this.position.y-t.y),i.z=-(this.position.z-t.z),i.normalize().multiplyScalar(this.SHOOT_SPEED),new w(this.position,i,this.SHOT_COLOR)}constructor(){super(0xf04040),this.SHOT_COLOR=0xffd0d0,this.SHOOT_INTERVAL=15,this.SHOOT_SPEED=4}}class y extends b{tick(t){this.randomizeVelocity(),super.tick(t)}randomizeVelocity(){let t=4+6*Math.random(),i=1-2*Math.floor(2*Math.random()),s=(.1*this.count+Math.random())*i;this.velocity.y=t*Math.cos(s),this.velocity.z=t*Math.sin(s)}constructor(){super(5263600),this.SHOT_COLOR=0xc0d0ff}}class O extends b{buildNewShot(){let t=.01*this.count,i=new o.Pq0(-.5,Math.sin(5*t)*Math.cos(t),Math.sin(5*t)*Math.sin(t));return i.normalize().multiplyScalar(this.SHOOT_SPEED),i.add(this.velocity),new w(this.position,i,this.SHOT_COLOR)}constructor(){super(57344),this.SHOT_COLOR=0xd0ffd0,this.SHOOT_INTERVAL=5,this.SHOOT_SPEED=1}}class _{tick(t,i){for(let s of(this.count++,this.canGenerate()&&this.generate(),this.list)){s.tick(t,i);let e=s.shoot(i);null!=e&&(this.shotList.push(e),this.graphics.add(e.graphics))}for(let t of(this.removeDeadEnemies(),this.shotList))t.tick();this.removeDeadShot()}generate(){let t,i=Math.floor(3e4*Math.random());t=i%3==0?new L:i%3==1?new y:new O,this.list.push(t),this.graphics.add(t.graphics)}canGenerate(){return this.count<=1800?this.count%180==0:this.count<=3600?this.count%120==0:this.count<=7200?this.count%60==0:this.count%30==0}removeDeadEnemies(){for(let t of(this.countShotDown=this.list.filter(t=>!t.isAlive&&t.isShotDown).length,this.list))t.isAlive||(this.graphics.remove(t.graphics),t.dispose());this.list=this.list.filter(t=>t.isAlive)}removeDeadShot(){for(let t of this.shotList)t.isAlive||(this.graphics.remove(t.graphics),t.dispose());this.shotList=this.shotList.filter(t=>t.isAlive)}buildGraphics(){return new o.YJl}constructor(){this.list=[],this.shotList=[],this.countShotDown=0,this.count=0,this.graphics=this.buildGraphics()}}let x=t=>{let i,{width:s,height:n,setPlayerLife:d,setScore:p}=t,m=(0,r.useRef)(0),w={},g=new u,v=new f,S=new _,b=new o.Z58,L=new o.dth(0xffffff,6316128,5),y=new o.ubm(60,s/n);return y.position.set(0,-800,800),y.lookAt(new o.Pq0(0,0,0)),b.add(L),b.add(g.graphics),b.add(v.graphics),b.add(v.shotList.graphics),b.add(S.graphics),(0,r.useEffect)(()=>{(i=new h.JeP({canvas:document.getElementById("game")})).setPixelRatio(window.devicePixelRatio),i.setSize(s,n)},[]),(0,r.useEffect)(()=>{c(()=>{void 0!==i&&(g.tick(),v.tick(w,S.list,S.shotList),d(v.life),S.tick(v.shotList,v.position),p(m.current+=S.countShotDown),i.render(b,y))})},[]),(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(l,{keysPressed:w}),(0,e.jsx)("canvas",{id:"game",width:s,height:n,className:a().gameCanvas})]})};var P=s(5855),A=s.n(P);let E=()=>{let[t,i]=(0,r.useState)(5),[s,o]=(0,r.useState)(0);return(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)("h1",{children:"Naname Shooting"}),(0,e.jsxs)("div",{className:A().scores,children:[(0,e.jsxs)("span",{id:"pl-score",className:A().pl_score,children:["PLAYER'S LIFE: ",t]}),(0,e.jsxs)("span",{id:"en-score",className:A().en_score,children:["KILL SCORE: ",s]})]}),(0,e.jsx)(x,{width:640,height:480,setPlayerLife:i,setScore:o})]})}},9120:t=>{t.exports={gameCanvas:"gameCanvas_gameCanvas__v5Dar"}}},t=>{var i=i=>t(t.s=i);t.O(0,[391,334,636,593,792],()=>i(6760)),_N_E=t.O()}]);